var powerbi;!function(e){var t;!function(e){var t;!function(e){function t(){var e="",t=0;for(t=0;32>t;t+=1){var i=16*Math.random()|0;switch(t){case 8:case 12:case 16:case 20:e+="-"}e+=i.toString(16)}return e}e.generateGuid=t}(t=e.telemetry||(e.telemetry={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){e.ExtensibilityVisualApiUsage=function(t,i,n,o,r,s,a){void 0===r&&(r=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0);var u={name:t,apiVersion:i,custom:n,parentId:o,isError:r,errorSource:s,errorCode:a},c={name:"PBI.Extensibility.VisualApiUsage",category:1,time:Date.now(),id:e.generateGuid(),getFormattedInfoObject:function(){var t={name:u.name,apiVersion:u.apiVersion,custom:u.custom,parentId:u.parentId,isError:u.isError};return"undefined"!=typeof u.errorSource&&(t.errorSource=e.ErrorSource[u.errorSource]),"undefined"!=typeof u.errorCode&&(t.errorCode=u.errorCode),t},info:u,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.ExtensibilityVisualApiUsageLoggers&&(c.loggers=e.ExtensibilityVisualApiUsageLoggers),c},e.VisualException=function(t,i,n,o,r,s,a,u){var c={visualType:t,isCustom:i,apiVersion:n,source:o,lineNumber:r,columnNumber:s,stack:a,message:u},p={name:"PBI.VisualException",category:2,time:Date.now(),id:e.generateGuid(),getFormattedInfoObject:function(){var e={visualType:c.visualType,isCustom:c.isCustom,apiVersion:c.apiVersion,source:c.source,lineNumber:c.lineNumber,columnNumber:c.columnNumber,stack:c.stack,message:c.message};return e},info:c,privateFields:[],orgInfoFields:[]};return"undefined"!=typeof e.VisualExceptionLoggers&&(p.loggers=e.VisualExceptionLoggers),p}}(t=e.telemetry||(e.telemetry={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t=function(){function e(e){this.hostServices=e.hostServices,this.selectedIds=[],this.promiseFactory=this.hostServices.promiseFactory()}return e.prototype.select=function(e,t){void 0===t&&(t=!1);var i=this.promiseFactory.defer();return this.hostServices.shouldRetainSelection()?this.sendSelectionToHost([e]):(this.selectInternal(e,t),this.sendSelectionToHost(this.selectedIds)),i.resolve(this.selectedIds),i.promise},e.prototype.showContextMenu=function(e,t){var i=this.promiseFactory.defer();return this.sendContextMenuToHost(e,t),i.resolve(null),i.promise},e.prototype.hasSelection=function(){return this.selectedIds.length>0},e.prototype.clear=function(){var e=this.promiseFactory.defer();return this.selectedIds=[],this.sendSelectionToHost([]),e.resolve(null),e.promise},e.prototype.getSelectionIds=function(){return this.selectedIds},e.prototype.sendSelectionToHost=function(e){var t={data:e.filter(function(e){return e.hasIdentity()}).map(function(e){return e.getSelector()})},i=this.getSelectorsByColumn(e);_.isEmpty(i)||(t.data2=i),this.hostServices.onSelect(t)},e.prototype.sendContextMenuToHost=function(e,t){var i=this.getSelectorsByColumn([e]);if(!_.isEmpty(i)){var n={data:i,position:t};this.hostServices.onContextMenu(n)}},e.prototype.getSelectorsByColumn=function(e){return _(e).filter(function(e){return e.hasIdentity}).map(function(e){return e.getSelectorsByColumn()}).compact().value()},e.prototype.selectInternal=function(t,i){e.containsSelection(this.selectedIds,t)?this.selectedIds=i?this.selectedIds.filter(function(e){return!t.equals(e)}):this.selectedIds.length>1?[t]:[]:i?this.selectedIds.push(t):this.selectedIds=[t]},e.containsSelection=function(e,t){return e.some(function(e){return t.equals(e)})},e}();e.SelectionManager=t}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=function(){function t(){}return t.prototype.withCategory=function(e,t){return e&&e.source&&e.source.queryName&&e.identity&&(this.ensureDataMap()[e.source.queryName]=e.identity[t]),this},t.prototype.withSeries=function(e,t){return e&&e.source&&e.source.queryName&&t&&(this.ensureDataMap()[e.source.queryName]=t.identity),this},t.prototype.withMeasure=function(e){return this.measure=e,this},t.prototype.createSelectionId=function(){return e.visuals.SelectionId.createWithSelectorForColumnAndMeasure(this.ensureDataMap(),this.measure)},t.prototype.ensureDataMap=function(){return this.dataMap||(this.dataMap={}),this.dataMap},t}();t.SelectionIdBuilder=i}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){function i(e,i){var n={name:e.name,apiVersion:e.apiVersion,custom:!!e.custom};return new t.VisualSafeExecutionWrapper(new o(e,i),n,i)}var n=e.visuals.telemetry.ExtensibilityVisualApiUsage;t.visualApiVersions=[],t.createVisualAdapter=i;var o=function(){function i(t,i){this.telemetryService=i,this.plugin=t;var o=t.apiVersion,r=this.getVersionIndex(o),s=!1;o?r>-1?(this.apiVersionIndex=r,this.legacy=!1):s=!0:this.legacy=!0,this.telemetryService&&this.telemetryService.logEvent(n,this.plugin.name,this.plugin.apiVersion,!!this.plugin.custom,void 0,s,e.visuals.telemetry.ErrorSource.User)}return i.prototype.init=function(e){if(e.element.empty(),this.legacy)this.visual=this.plugin.create(),this.visualLegacy.init(e);else{var i=t.visualApiVersions[this.apiVersionIndex].hostAdapter(e.host);this.visual=this.plugin.create({element:e.element.get(0),host:i}),this.overloadMethods()}},i.prototype.update=function(t){t.type&e.VisualUpdateType.Resize&&this.visualHasMethod("onResizing")?this.onResizing(t.viewport,t.resizeMode):this.visualHasMethod("update")?this.visualLegacy.update(t):((!t.type||t.type&e.VisualUpdateType.Data)&&this.onDataChanged(_.pick(t,["dataViews","operationKind"])),t.type&e.VisualUpdateType.ViewMode&&this.onViewModeChanged(t.viewMode))},i.prototype.destroy=function(){this.visualHasMethod("destroy")&&this.visualLegacy.destroy()},i.prototype.enumerateObjectInstances=function(e){return this.visualHasMethod("enumerateObjectInstances")?this.visualLegacy.enumerateObjectInstances(e):void 0},i.prototype.onResizing=function(e,t){this.visualHasMethod("onResizing")&&this.visualLegacy.onResizing(e,t)},i.prototype.onDataChanged=function(e){this.visualHasMethod("onDataChanged")&&this.visualLegacy.onDataChanged(e)},i.prototype.onViewModeChanged=function(e){this.visualHasMethod("onViewModeChanged")&&this.visualLegacy.onViewModeChanged(e)},i.prototype.onClearSelection=function(){this.visualHasMethod("onClearSelection")&&this.visualLegacy.onClearSelection()},i.prototype.canResizeTo=function(e){return this.visualHasMethod("canResizeTo")?this.visualLegacy.canResizeTo(e):void 0},i.prototype.unwrap=function(){return this.visual},Object.defineProperty(i.prototype,"visualNew",{get:function(){return this.legacy?void 0:this.visual},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visualLegacy",{get:function(){return this.legacy?this.visual:void 0},enumerable:!0,configurable:!0}),i.prototype.visualHasMethod=function(e){var t=this.legacy?this.visualLegacy:this.visualNew;return t&&_.isFunction(t[e])},i.prototype.getVersionIndex=function(e){if(e)for(var i=t.visualApiVersions.length,n=0;i>n;n++)if(t.visualApiVersions[n].version===e)return n;return-1},i.prototype.overloadMethods=function(){var e=this.getCompiledOverloads();for(var t in e)this[t]=e[t]},i.prototype.getCompiledOverloads=function(){for(var e={},i=this.apiVersionIndex,n=this.visualNew,o=0;i>=o;o++){var r=t.visualApiVersions[o].overloads;_.isFunction(r)&&_.assign(e,r(n))}return e},i}();t.VisualAdapter=o}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i=e.visuals.telemetry.VisualException,n=function(){function e(e,t,i,n){this.wrappedVisual=e,this.visualInfo=t,this.telemetryService=i,this.silent=n}return e.prototype.init=function(e){var t=this;this.wrappedVisual.init&&this.executeSafely(function(){return t.wrappedVisual.init(e)})},e.prototype.destroy=function(){var e=this;this.wrappedVisual.destroy&&this.executeSafely(function(){return e.wrappedVisual.destroy()})},e.prototype.update=function(e){var t=this;this.wrappedVisual.update&&this.executeSafely(function(){return t.wrappedVisual.update(e)})},e.prototype.onResizing=function(e,t){var i=this;this.wrappedVisual.onResizing&&this.executeSafely(function(){return i.wrappedVisual.onResizing(e,t)})},e.prototype.onDataChanged=function(e){var t=this;this.wrappedVisual.onDataChanged&&this.executeSafely(function(){return t.wrappedVisual.onDataChanged(e)})},e.prototype.onViewModeChanged=function(e){var t=this;this.wrappedVisual.onViewModeChanged&&this.executeSafely(function(){return t.wrappedVisual.onViewModeChanged(e)})},e.prototype.onClearSelection=function(){var e=this;this.wrappedVisual.onClearSelection&&this.executeSafely(function(){return e.wrappedVisual.onClearSelection()})},e.prototype.canResizeTo=function(e){var t=this;return this.wrappedVisual.canResizeTo?this.executeSafely(function(){return t.wrappedVisual.canResizeTo(e)}):void 0},e.prototype.enumerateObjectInstances=function(e){var t=this;return this.wrappedVisual.enumerateObjectInstances?this.executeSafely(function(){return t.wrappedVisual.enumerateObjectInstances(e)}):void 0},e.prototype.unwrap=function(){var e=this.wrappedVisual;return e.unwrap?e.unwrap():e},e.prototype.isCustomVisual=function(){return this.visualInfo.custom},e.prototype.executeSafely=function(e){try{return e()}catch(t){!this.silent,this.telemetryService&&this.telemetryService.logEvent(i,this.visualInfo.name,this.visualInfo.custom,this.visualInfo.apiVersion,t.fileName,t.lineNumber,t.columnNumber,t.stack,t.message)}},e}();t.VisualSafeExecutionWrapper=n}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){var n=function(t){return{update:function(i){if(t.update){var n=i.type||e.VisualUpdateType.Data;n&e.VisualUpdateType.Resize&&2===i.resizeMode&&(n|=e.VisualUpdateType.ResizeEnd),t.update({viewport:i.viewport,dataViews:i.dataViews,type:n})}},destroy:function(){t.destroy&&t.destroy()},enumerateObjectInstances:function(e){return t.enumerateObjectInstances?t.enumerateObjectInstances(e):void 0}}},o=function(e){return{}};t.visualApiVersions.push({version:"1.0.0",overloads:n,hostAdapter:o})}(i=t.v100||(t.v100={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(i){var n=function(i){return{createSelectionIdBuilder:function(){return new e.visuals.SelectionIdBuilder},createSelectionManager:function(){return new t.SelectionManager({hostServices:i})}}};t.visualApiVersions.push({version:"1.1.0",hostAdapter:n})}(i=t.v110||(t.v110={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));
//# sourceMappingURL=VisualsExtensibility.min.js.map
